## iOS/Objective-C 计算机网络面试 Q&A 精选（清晰题干 + 详解）

1) 问：HTTP/1.1 与 HTTP/2 的核心差异是什么？在 iOS 上有什么直接收益？
   答：
   - HTTP/1.1：长连接但串行队头阻塞，需要多连接并发增加开销。
   - HTTP/2：单连接多路复用、HPACK 头压缩与更好的优先级管理，减少握手与头开销，缓解队头阻塞。
   - iOS 收益：URLSession 自动协商 HTTP/2，显著降低建连成本与首包时延，列表页多资源并行加载更顺滑。

2) 问：什么时候需要考虑 HTTP/3（QUIC）？
   答：弱网与网络切换频繁、对时延极敏感（直播/通话/实时互动）场景。QUIC 基于 UDP，具备 0-RTT/1-RTT 握手、无队头阻塞、连接迁移，移动网络稳定性更好，前提是系统与服务端栈支持。

3) 问：如何在客户端落实请求幂等与安全的重试？
   答：
   - 幂等键 + 时间戳 + Nonce + HMAC/RSA 签名，服务端去重与过期校验。
   - 仅对网络错误/超时重试，禁止对已执行成功但响应丢失的高风险业务盲目重试；指数退避，有限次数。

4) 问：弱网下图片墙如何优化？
   答：
   - 降级分辨率/质量、先缩略再原图；滚动时暂停低优先级请求；并发与带宽限流；缓存与预取；后台解码，主线程只显示。

5) 问：什么是 ATS、Pinning，工程上如何既安全又可回退？
   答：
   - ATS：默认要求 HTTPS；非 HTTPS 需白名单且收敛范围。
   - Pinning：绑定公钥/指纹防中间人；需多指纹冗余与灰度开关，避免证书更新时全量故障。

6) 问：URLSession 背景会话适合哪些下载/上传？
   答：大文件/长耗时任务，进程退出仍能进行，系统按能耗策略调度，支持断点续传与任务恢复；前台体验更稳。

---

## iOS/Objective-C 计算机网络面试指南（工程实战向）

面向 iOS/OC 工程的网络知识与实践，覆盖：TCP/UDP、HTTP/1.1 与 HTTP/2/3、TLS/HTTPS、安全（ATS/证书锁定/签名）、可靠传输（重试/幂等/断点续传）、性能优化（连接复用、队列、缓存、预取）、移动网络特性（弱网、切换、代理、数据节流）。

---

### 1. 基础协议与传输

- TCP 与 UDP
  - TCP：面向连接、可靠传输、流控制、拥塞控制、顺序到达；适合大多数 App API 传输。
  - UDP：无连接、尽力而为、时延低；适用于实时性强（音视频/游戏）的自建协议场景。
  - iOS 实战：API 调用基于 TCP（HTTP/HTTPS），音视频/实时互动可采用 QUIC/UDP 通道或专用 SDK。

- 三次握手/四次挥手与慢启动
  - 握手带来首包延迟，频繁建连会放大；应复用连接或使用 HTTP/2 多路复用。
  - 慢启动会限制初始吞吐，服务端可优化初始拥塞窗口，客户端侧通过缓存/预取减少首包压力。

---

### 2. HTTP 演进：1.1 → 2 → 3（QUIC）

- HTTP/1.1
  - 长连接 + 串行队头阻塞；多域名分片与并发连接增加资源占用。
  - iOS 实战：URLSession 默认支持 HTTP/1.1；对同域并发有上限；连接池对复用效果关键。

- HTTP/2
  - 单连接多路复用、HPACK 头压缩、服务端推送；明显降低握手与头开销，缓解队头阻塞。
  - iOS 实战：URLSession 自动升级至 HTTP/2（TLS ALPN）；需服务端支持；对慢资源优先级管理更好。

- HTTP/3（QUIC）
  - 基于 UDP，0-RTT/1-RTT 握手、无队头阻塞、连接迁移（更利于移动网络切换）。
  - iOS 实战：依赖系统与服务端栈支持；对弱网切换、时延敏感业务（音视频/实时互动）收益明显。

---

### 3. HTTPS/TLS 与安全

- ATS（App Transport Security）
  - 要求 HTTPS；如需 HTTP 白名单必须最小化范围并有业务豁免理由。

- TLS 握手与配置
  - 证书链、SNI、ALPN、Session Resumption（减少握手开销），优选 TLS 1.2/1.3。

- 证书锁定（Certificate Pinning）
  - 绑定公钥/证书指纹，抵御中间人攻击；需配套灰度与应急策略（多指纹、远程下发）。

- 请求签名与重放防护
  - 基于时间戳、Nonce、签名（HMAC/RSA）；配合服务端时钟漂移容忍；对幂等接口使用 POST+幂等键或 PUT。

---

### 4. URLSession 架构与实践

- 会话与任务模型
  - `URLSessionConfiguration`（default/ephemeral/background），`URLSession`，`URLSessionTask`（data/upload/download）。
  - 后台任务：进程退出仍可继续，配合系统电量/网络策略；适合大下载/断点续传。

- 连接与队列
  - 连接池：同域并发上限、Keep-Alive 超时；减少新建连接。
  - 任务优先级：根据业务重要度设置；临时数据可降级。
  - 线程与回调：避免在主线程进行数据解析与磁盘 IO。

- 缓存与重试
  - HTTP 缓存（ETag/If-None-Match、Last-Modified/If-Modified-Since）；合理的 Cache-Control。
  - 重试策略：指数退避、幂等保障；对不可重试的接口（转账/订单）必须落地去重机制。

---

### 5. 移动网络特性与优化

- 弱网与切换
  - 蜂窝/Wi‑Fi 切换导致 IP 变化与连接中断；HTTP/3 的连接迁移更稳。
  - 弱网节流：小图占位 + 渐进式加载；接口合并；数据压缩；按需返回。

- 代理与企业网络
  - 代理可能修改证书链；与 Pinning 冲突时需策略回退或允许企业证书信任。

- 省流量与功耗
  - 合并请求、批处理上报；非实时数据延迟至空闲/充电/Wi‑Fi；优先使用系统后台传输。

---

### 6. 性能与稳定性策略

- 首屏与关键路径
  - 第一屏接口并行、强弱依赖拆分、降级/占位。

- 大文件与断点续传
  - 使用 `URLSessionDownloadTask` 与背景会话；保存偏移，防止重下；校验完整性（哈希）。

- 超时与取消
  - 合理的 `timeoutInterval`; 在视图消失或需求变化时及时 `cancel`，减少资源浪费。

- 可观测性
  - 统一打点：DNS、TCP、TLS、TTFB、首包、总时长、重试次数、命中缓存；错误分层（4xx/5xx/超时/断网）。

---

### 7. 场景题与回答思路

- 场景：弱网下图片墙加载很慢、滚动卡顿。
  - 策略：降级分辨率与质量、先缩略图后原图；并发控制与优先级；滚动时暂停非首屏请求；缓存与预取；后台解码。

- 场景：企业 Wi‑Fi 下 HTTPS 报错，线下门店无法使用。
  - 策略：企业代理插入证书；提供受控白名单或企业证书信任策略；对关键业务预留 HTTP/2 明确降级通道（评估风险）。

- 场景：支付接口幂等与重试设计。
  - 策略：幂等键、防重放签名、严格时序；客户端失败只在网络/超时重试，禁止业务逻辑已执行时重试；最终一致性回补。

---

以上覆盖 iOS/OC 工程常见网络问题的系统化解法，面试中应结合指标、数据与权衡给出工程取舍与复盘闭环。


